---
title: "hw11"
output: pdf_document
date: "2023-12-08"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**hw_lect_27.1**



a).
```{r}
rm(list=ls(all=TRUE))
library(nlme)
y.m = matrix(c(
50, 49, 50, 50, 48, 51,
52, 52, 51, 51, 51, 51,
53, 50, 50, 54, 52, 51,
49, 51, 50, 48, 50, 51,
48, 49, 48, 48, 49, 48,
52, 50, 50, 52, 50, 50,
51, 51, 51, 51, 50, 50,
52, 50, 49, 53, 48, 50,
50, 51, 50, 51, 48, 49,
47, 46, 49, 46, 47, 48), ncol = 6, byrow=T)
y = as.vector(t(y.m))
part = as.factor(rep(1:10,each=6))
oper = as.factor(rep(rep(1:2,each=3),10))
lm.1 = lm(y ~ part + oper + oper:part)
summary(aov(lm.1))
```

MSA is 11.002, MSB is 1.850, MSAB is 0.869, MSE is 1.550



b).
$$H0: \sigma_A^2 = 0 , H1: \sigma_A^2 > 0$$
$$H0: \sigma_B^2 = 0 , H1: \sigma_B^2 > 0$$
$$H0: \sigma_{AB}^2 = 0 , H1: \sigma_{AB}^2 > 0$$
```{r}
n = 3
a = 10
b = 2
MS_A = 11.002
MS_B = 0.417
MS_AB = 0.602
MS_E = 1.500
F_A <- MS_A/MS_AB
F_B <- MS_B/MS_AB
F_AB <- MS_AB/MS_E
p_A <- pf(F_A, a-1, (a-1)*(b-1), lower.tail = FALSE)
p_B <- pf(F_B, b-1, (a-1)*(b-1), lower.tail = FALSE)
p_AB <- pf(F_AB, (a-1)*(b-1), a*b*n-a*b, lower.tail = FALSE)
F_A
F_B
F_AB
p_A
p_B
p_AB
```


c).
$$H0: \sigma_A^2 = 0 , H1: \sigma_A^2 > 0$$
Since p-value of part is `r p_A`, which is significantly small, there is a difference in the response across all treatment levels in the population.

$$H0: \sigma_B^2 = 0 , H1: \sigma_B^2 > 0$$
Since p-value of operation is `r p_B`, which is not significantly small, we can not reject the null hypothesis and can not conclude that there is a difference in the response across all treatment levels in the population.

$$H0: \sigma_{AB}^2 = 0 , H1: \sigma_{AB}^2 > 0$$
Since p-value of part and operation is `r p_AB`, which is not significantly small, we can not reject the null hypothesis and can not conclude that there is a difference in the response across all treatment levels in the population.


d).
```{r}
# variance components: A = part, B = oper.
var_alpha = ( MS_A - MS_AB )/(b*n)
var_beta = ( MS_B - MS_AB )/(a*n)
var_alpha_beta = (MS_AB - MS_E)/n
var_epsilon = MS_E
c(var_alpha, var_beta, var_alpha_beta, var_epsilon)
```
Some non-zero proportion of the variability in the response is due to the variability between the randomly selected treatment levels. Since $\sigma_A^2=1.733333333$ has relatively larger value, the part has an effect on the capability of a measurement system. Since $\sigma_B^2$ and $\sigma_{AB}^2$ are negative, we assume they are really zero, so there are no effect.
$\sigma_{\epsilon}^2$ represents the typical variability within each group is 1.5.

e).
```{r}
sum_v_comp <- var_alpha+var_beta+var_alpha_beta+var_epsilon
var_y <- var(y)
sum_v_comp
var_y
```
The sum of the four variance component estimates is supposed to be approximately equal to variance of y. Yes, it is. Becasue the sum of the four variance component estimates is `r sum_v_comp` and the variance of y is `r var_y`.